      PARAMETER(IMAXX=3000,JMAXX=2000,NXMAX=5000,NFFTSTEPS=50000,
     &KGMAX1=500,ITSTART=0)
      PARAMETER(NW=NFFTSTEPS+1,NCOLLECTORS=10)

      DOUBLE PRECISION N0LEVEL0,PUMPRATE0
      COMMON/PARAGAIN/N0LEVEL0,PUMPRATE0

      COMMON/INTEGERS/NX,NY,NSTEPS,NLINE,IMAX,JMAX,
     &LENGTHX,LENGTHY,KDIV,NWHITE,NTOTAL,ISOURCE,LL
      COMMON/ICONTROL/INITIALIZE,IPOLAR,IOVERLAP,IGAIN,IST,IBIGSCAT
      INTEGER NCOL(2,NCOLLECTORS)
      COMMON/IRANDOM/NCOL
	INTEGER SC,TSTART
	COMMON/SS/SC,TSTART
      
      DOUBLE PRECISION DX,DT,CH,BACKROUND,EPS1,A,CC
     &XLENGTH,YLENGTH,AMPLITUDE,
     &RADIUS,JSTAR,JENDO
      COMMON/RPARAMET/DX,DT,CH,BACKROUND,EPS1,A,CC
     &XLENGTH,YLENGTH,AMPLITUDE,
     &RADIUS,JSTAR,JENDO

      DOUBLE PRECISION CE1(IMAXX,JMAXX),
     &CE2(IMAXX,JMAXX),CE3(IMAXX,JMAXX)

      COMMON/ARRAYS/CE1,CE2,CE3

  
      DOUBLE PRECISION C0,EPS0,PI,XMU0,COND0,COND1
      COMMON/CONSTANTS/C0,EPS0,PI,XMU0,COND0,COND1
      
      DOUBLE PRECISION F1R(IMAXX,JMAXX),F2R(IMAXX,JMAXX),
     &F3R(IMAXX,JMAXX),F1R1(IMAXX,JMAXX),
     &F4R(IMAXX,JMAXX),F4R1(IMAXX,JMAXX),
     &FRR(IMAXX,JMAXX),SMIZ(IMAXX,JMAXX)
      COMMON/FIELDS/F1R,F1R1,F2R,F3R,F4R,F4R1,
     &FRR,SMIZ
 
      DOUBLE PRECISION EINCR(JMAXX),HINCR(JMAXX),NSOURCE(IMAXX,JMAXX)
      COMMON/SOURCES/EINCR,HINCR
      COMMON/NSOURCES/NSOURCE

      DOUBLE PRECISION ABCXR(6,7,JMAXX),
     &ABCYR(6,7,IMAXX),TX(6,7),TY(6,7)
      COMMON/ABC/ABCXR,ABCYR,TX,TY

C Make Changes for nonlinear medium      
c      DOUBLE PRECISION NALEVEL(IMAXX,JMAXX),DN(IMAXX,JMAXX)
c      COMMON/NONPOPU/NALEVEL,DN

      DOUBLE PRECISION W0,W1,WI
      COMMON/NONPARA/W0,W1,WI

      DOUBLE PRECISION CPZ1,CPZ2,CPZ3,
     &CN1LEVEL1,CN1LEVEL2,CN1LEVEL3,
     &CN1LEVEL4,CN2LEVEL1,CN2LEVEL2,CN2LEVEL3,CN3LEVEL1,CN3LEVEL2,
     &CN0LEVEL1,CN0LEVEL2,CN0LEVEL3
      COMMON/NONCOF/CPZ1,CPZ2,CPZ3,
     &CN1LEVEL1,CN1LEVEL2,CN1LEVEL3,
     &CN1LEVEL4,CN2LEVEL1,CN2LEVEL2,CN2LEVEL3,CN3LEVEL1,CN3LEVEL2,
     &CN0LEVEL1,CN0LEVEL2,CN0LEVEL3
      
      DOUBLE PRECISION KI3(IMAXX,JMAXX)
      COMMON/NONLINEARITY/KI3    
             
C Make Changes for Gain medium
      DOUBLE PRECISION hbar,electrone,electronm
      COMMON/ELECTRON/hbar,electrone,electronm

      DOUBLE PRECISION T2,TTRANS3,TTRANS31,TTRANS32,TTRANS2,
     &TTRANS21,TTRANS10,DELTAW,ki
      COMMON/GAIN/T2,TTRANS3,TTRANS31,TTRANS32,TTRANS2,
     &TTRANS21,TTRANS10,DELTAW,ki

      DOUBLE PRECISION N0LEVEL(IMAXX,JMAXX),N1LEVEL(IMAXX,JMAXX),   
     &N2LEVEL(IMAXX,JMAXX),N3LEVEL(IMAXX,JMAXX),DELTAN(IMAXX,JMAXX)
      COMMON/POPU/N0LEVEL,N1LEVEL,N2LEVEL,N3LEVEL,DELTAN




